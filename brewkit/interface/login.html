<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="A front-end template that helps you build fast, modern mobile web apps.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <title>Configure</title>

  <!-- Add to homescreen for Chrome on Android -->
  <meta name="mobile-web-app-capable" content="yes">

  <!-- Add to homescreen for Safari on iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Material Design Lite">

  <!-- JS -->
  <script src="js/libs/material.min.js"></script>
  <script src="js/libs/cookie.js"></script>
  <script src="js/libs/vue.js"></script>
  <script src="js/libs/socket.io.min.js"></script>
  <script src="js/libs/jquery.min.js"></script>

  <style>
    body {
      height: 10em;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #FAFAFA;
    }
  </style>

  <!-- CSS -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.teal-blue.min.css" />
  <!-- Custom CSS -->
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/animate.css">
</head>

<body>
  <div id="password">
    <div id="passwordCard" class="colored-card--green animated rounded-corners mdl-card mdl-shadow--8dp">
      <div class="mdl-card__title mdl-card--expand">
        <h2 class="mdl-card__title-text">Enter the Passphrase</h2>
      </div>
      <div class="mdl-card__supporting-text">
        <div id="password_input_container" class="mdl-textfield animated mdl-js-textfield mdl-textfield--floating-label">
          <input v-model="passwordInput" class="mdl-textfield__input animated"
            type="text" id="passwordInput ">
          <label class="mdl-textfield__label" for="passwordInput">Password</label>
        </div>
        {{ message }}
      </div>
      <div class="mdl-card__actions mdl-card--border">
        <button @click="login()" class="mdl-button rounded-button-corners small-button mdl-js-button mdl-button--colored mdl-js-ripple-effect">
          <i class="material-icons">arrow_forward</i>
          Login
        </button>
      </div>
    </div>
  </div>
  <!-- Custom JS -->
  <script src="js/socket.js"></script>
  <script>
    $.fn.extend({
      animateCss: function (animationName, callback) {
        var animationEnd = (function (el) {
          var animations = {
            animation: 'animationend',
            OAnimation: 'oAnimationEnd',
            MozAnimation: 'mozAnimationEnd',
            WebkitAnimation: 'webkitAnimationEnd',
          };

          for (var t in animations) {
            if (el.style[t] !== undefined) {
              return animations[t];
            }
          }
        })(document.createElement('div'));

        this.addClass('animated ' + animationName).one(animationEnd, function () {
          $(this).removeClass('animated ' + animationName);

          if (typeof callback === 'function') callback();
        });

        return this;
      },
    });

    var x = new Vue({
      el: "#password",
      data: {
        passwordInput: ''
      },
      methods: {
        login() {
          if (this.passwordInput != '') {
            socket.emit('password', this.passwordInput, function(result) {
              if (result) {
                Cookies.set('user', 'admin')
                x.message = 'Logged in. Redirecting.';
                location = "index.html";
              } else {
                $('#passwordCard').animateCss('shake');
                x.passwordInput = '';
                x.message = 'Incorrect password';
              }
            })
          }
        }
      }
    })
  </script>
</body>

</html>
